import re
import numpy as np
from sympy import sympify, diff, symbols


def parse_basis(expr_str):
    # 添加显式乘法符号
    expr_str = re.sub(r'([xyz)\d]).(?=[xyz(])', r'\1*', expr_str)
    # expr_str = re.sub(r')(?=\()', ')*', expr_str)
    
    x, y, z = symbols('x y z')
    expr = sympify(expr_str)
    
    dx = diff(expr, x)
    dy = diff(expr, y)
    dz = diff(expr, z)
    
    return {
        'expr': expr,
        'grad': [dx, dy, dz]
    }

def generate_cpp_code(basis_id, expr_info):
    n=basis_id+1
    cpp = f"""
// Basis {basis_id}
template<>
struct DGBasis2D<{basis_id}> {{
    template<typename Type>
    HostDevice constexpr static Type eval(Type x, Type y) {{
        return {cpp_code(expr_info['expr'])};
    }}
    
    template<typename Type>
    HostDevice constexpr static std::array<Scalar,2> grad(Type x, Type y) {{
        return {{
            {cpp_code(expr_info['grad'][0])},
            {cpp_code(expr_info['grad'][1])}
        }};
    }}
    static constexpr uInt Order = {int(np.ceil(-0.0001-2 + (27*n + np.sqrt(-3 + 729*n**2))**(1/3)/3**(2/3) + 1/(81*n + 3*np.sqrt(-3 + 729*n**2))**(1/3)))};
}};"""
    return cpp

def cpp_code(expr):
    from sympy.printing.cxx import cxxcode
    return cxxcode(expr, standard='C++17', 
                  user_functions={'Pow': 'std::pow'})





ssss="""{
 {{1}},
 {{-1 + 3 x, -1 + x + 2 y}},
 {{1 - 8 x + 10 x^2, (-1 + 5 x) (-1 + x + 2 y), 
   1 + x^2 - 6 y + 6 y^2 + x (-2 + 6 y)}},
 {{-1 + 15 x - 45 x^2 + 
    35 x^3, (1 - 12 x + 21 x^2) (-1 + x + 2 y), (-1 + 7 x) (1 + x^2 - 
      6 y + 6 y^2 + x (-2 + 6 y)), -1 + x^3 + 12 y - 30 y^2 + 
    20 y^3 + 3 x^2 (-1 + 4 y) + 3 x (1 - 8 y + 10 y^2)}},
 {{1 - 24 x + 126 x^2 - 224 x^3 + 
    126 x^4, (-1 + 21 x - 84 x^2 + 84 x^3) (-1 + x + 2 y), (1 - 
      16 x + 36 x^2) (1 + x^2 - 6 y + 6 y^2 + x (-2 + 6 y)), (-1 + 
      9 x) (-1 + x^3 + 12 y - 30 y^2 + 20 y^3 + 3 x^2 (-1 + 4 y) + 
      3 x (1 - 8 y + 10 y^2)), 
   1 + x^4 - 20 y + 90 y^2 - 140 y^3 + 70 y^4 + 4 x^3 (-1 + 5 y) + 
    x^2 (6 - 60 y + 90 y^2) + 4 x (-1 + 15 y - 45 y^2 + 35 y^3)}},
 {{-1 + 35 x - 280 x^2 + 840 x^3 - 1050 x^4 + 
    462 x^5, (1 - 32 x + 216 x^2 - 480 x^3 + 330 x^4) (-1 + x + 
      2 y), (-1 + 27 x - 135 x^2 + 165 x^3) (1 + x^2 - 6 y + 6 y^2 + 
      x (-2 + 6 y)), (1 - 20 x + 55 x^2) (-1 + x^3 + 12 y - 30 y^2 + 
      20 y^3 + 3 x^2 (-1 + 4 y) + 3 x (1 - 8 y + 10 y^2)), (-1 + 
      11 x) (1 + x^4 - 20 y + 90 y^2 - 140 y^3 + 70 y^4 + 
      4 x^3 (-1 + 5 y) + x^2 (6 - 60 y + 90 y^2) + 
      4 x (-1 + 15 y - 45 y^2 + 35 y^3)), -1 + x^5 + 30 y - 210 y^2 + 
    560 y^3 - 630 y^4 + 252 y^5 + 5 x^4 (-1 + 6 y) + 
    10 x^3 (1 - 12 y + 21 y^2) + 
    10 x^2 (-1 + 18 y - 63 y^2 + 56 y^3) + 
    5 x (1 - 24 y + 126 y^2 - 224 y^3 + 126 y^4)}},
 {{1 - 48 x + 540 x^2 - 2400 x^3 + 4950 x^4 - 4752 x^5 + 
    1716 x^6, (-1 + 45 x - 450 x^2 + 1650 x^3 - 2475 x^4 + 
      1287 x^5) (-1 + x + 2 y), (1 - 40 x + 330 x^2 - 880 x^3 + 
      715 x^4) (1 + x^2 - 6 y + 6 y^2 + x (-2 + 6 y)), (-1 + 33 x - 
      198 x^2 + 286 x^3) (-1 + x^3 + 12 y - 30 y^2 + 20 y^3 + 
      3 x^2 (-1 + 4 y) + 3 x (1 - 8 y + 10 y^2)), (1 - 24 x + 
      78 x^2) (1 + x^4 - 20 y + 90 y^2 - 140 y^3 + 70 y^4 + 
      4 x^3 (-1 + 5 y) + x^2 (6 - 60 y + 90 y^2) + 
      4 x (-1 + 15 y - 45 y^2 + 35 y^3)), (-1 + 13 x) (-1 + x^5 + 
      30 y - 210 y^2 + 560 y^3 - 630 y^4 + 252 y^5 + 
      5 x^4 (-1 + 6 y) + 10 x^3 (1 - 12 y + 21 y^2) + 
      10 x^2 (-1 + 18 y - 63 y^2 + 56 y^3) + 
      5 x (1 - 24 y + 126 y^2 - 224 y^3 + 126 y^4)), 
   1 + x^6 - 42 y + 420 y^2 - 1680 y^3 + 3150 y^4 - 2772 y^5 + 
    924 y^6 + 6 x^5 (-1 + 7 y) + 15 x^4 (1 - 14 y + 28 y^2) + 
    20 x^3 (-1 + 21 y - 84 y^2 + 84 y^3) + 
    15 x^2 (1 - 28 y + 168 y^2 - 336 y^3 + 210 y^4) + 
    6 x (-1 + 35 y - 280 y^2 + 840 y^3 - 1050 y^4 + 462 y^5)}},
 {{-1 + 63 x - 945 x^2 + 5775 x^3 - 17325 x^4 + 27027 x^5 - 
    21021 x^6 + 
    6435 x^7, (1 - 60 x + 825 x^2 - 4400 x^3 + 10725 x^4 - 
      12012 x^5 + 5005 x^6) (-1 + x + 2 y), (-1 + 55 x - 660 x^2 + 
      2860 x^3 - 5005 x^4 + 3003 x^5) (1 + x^2 - 6 y + 6 y^2 + 
      x (-2 + 6 y)), (1 - 48 x + 468 x^2 - 1456 x^3 + 1365 x^4) (-1 + 
      x^3 + 12 y - 30 y^2 + 20 y^3 + 3 x^2 (-1 + 4 y) + 
      3 x (1 - 8 y + 10 y^2)), (-1 + 39 x - 273 x^2 + 455 x^3) (1 + 
      x^4 - 20 y + 90 y^2 - 140 y^3 + 70 y^4 + 4 x^3 (-1 + 5 y) + 
      x^2 (6 - 60 y + 90 y^2) + 
      4 x (-1 + 15 y - 45 y^2 + 35 y^3)), (1 - 28 x + 105 x^2) (-1 + 
      x^5 + 30 y - 210 y^2 + 560 y^3 - 630 y^4 + 252 y^5 + 
      5 x^4 (-1 + 6 y) + 10 x^3 (1 - 12 y + 21 y^2) + 
      10 x^2 (-1 + 18 y - 63 y^2 + 56 y^3) + 
      5 x (1 - 24 y + 126 y^2 - 224 y^3 + 126 y^4)), (-1 + 15 x) (1 + 
      x^6 - 42 y + 420 y^2 - 1680 y^3 + 3150 y^4 - 2772 y^5 + 
      924 y^6 + 6 x^5 (-1 + 7 y) + 15 x^4 (1 - 14 y + 28 y^2) + 
      20 x^3 (-1 + 21 y - 84 y^2 + 84 y^3) + 
      15 x^2 (1 - 28 y + 168 y^2 - 336 y^3 + 210 y^4) + 
      6 x (-1 + 35 y - 280 y^2 + 840 y^3 - 1050 y^4 + 462 y^5)), -1 + 
    x^7 + 56 y - 756 y^2 + 4200 y^3 - 11550 y^4 + 16632 y^5 - 
    12012 y^6 + 3432 y^7 + 7 x^6 (-1 + 8 y) + 
    21 x^5 (1 - 16 y + 36 y^2) + 
    35 x^4 (-1 + 24 y - 108 y^2 + 120 y^3) + 
    35 x^3 (1 - 32 y + 216 y^2 - 480 y^3 + 330 y^4) + 
    21 x^2 (-1 + 40 y - 360 y^2 + 1200 y^3 - 1650 y^4 + 792 y^5) + 
    7 x (1 - 48 y + 540 y^2 - 2400 y^3 + 4950 y^4 - 4752 y^5 + 
       1716 y^6)}},
 {{1 - 80 x + 1540 x^2 - 12320 x^3 + 50050 x^4 - 112112 x^5 + 
    140140 x^6 - 91520 x^7 + 
    24310 x^8, (-1 + 77 x - 1386 x^2 + 10010 x^3 - 35035 x^4 + 
      63063 x^5 - 56056 x^6 + 19448 x^7) (-1 + x + 2 y), (1 - 72 x + 
      1170 x^2 - 7280 x^3 + 20475 x^4 - 26208 x^5 + 12376 x^6) (1 + 
      x^2 - 6 y + 6 y^2 + x (-2 + 6 y)), (-1 + 65 x - 910 x^2 + 
      4550 x^3 - 9100 x^4 + 6188 x^5) (-1 + x^3 + 12 y - 30 y^2 + 
      20 y^3 + 3 x^2 (-1 + 4 y) + 3 x (1 - 8 y + 10 y^2)), (1 - 
      56 x + 630 x^2 - 2240 x^3 + 2380 x^4) (1 + x^4 - 20 y + 
      90 y^2 - 140 y^3 + 70 y^4 + 4 x^3 (-1 + 5 y) + 
      x^2 (6 - 60 y + 90 y^2) + 
      4 x (-1 + 15 y - 45 y^2 + 35 y^3)), (-1 + 45 x - 360 x^2 + 
      680 x^3) (-1 + x^5 + 30 y - 210 y^2 + 560 y^3 - 630 y^4 + 
      252 y^5 + 5 x^4 (-1 + 6 y) + 10 x^3 (1 - 12 y + 21 y^2) + 
      10 x^2 (-1 + 18 y - 63 y^2 + 56 y^3) + 
      5 x (1 - 24 y + 126 y^2 - 224 y^3 + 126 y^4)), (1 - 32 x + 
      136 x^2) (1 + x^6 - 42 y + 420 y^2 - 1680 y^3 + 3150 y^4 - 
      2772 y^5 + 924 y^6 + 6 x^5 (-1 + 7 y) + 
      15 x^4 (1 - 14 y + 28 y^2) + 
      20 x^3 (-1 + 21 y - 84 y^2 + 84 y^3) + 
      15 x^2 (1 - 28 y + 168 y^2 - 336 y^3 + 210 y^4) + 
      6 x (-1 + 35 y - 280 y^2 + 840 y^3 - 1050 y^4 + 
         462 y^5)), (-1 + 17 x) (-1 + x^7 + 56 y - 756 y^2 + 
      4200 y^3 - 11550 y^4 + 16632 y^5 - 12012 y^6 + 3432 y^7 + 
      7 x^6 (-1 + 8 y) + 21 x^5 (1 - 16 y + 36 y^2) + 
      35 x^4 (-1 + 24 y - 108 y^2 + 120 y^3) + 
      35 x^3 (1 - 32 y + 216 y^2 - 480 y^3 + 330 y^4) + 
      21 x^2 (-1 + 40 y - 360 y^2 + 1200 y^3 - 1650 y^4 + 792 y^5) + 
      7 x (1 - 48 y + 540 y^2 - 2400 y^3 + 4950 y^4 - 4752 y^5 + 
         1716 y^6)), 
   1 + x^8 - 72 y + 1260 y^2 - 9240 y^3 + 34650 y^4 - 72072 y^5 + 
    84084 y^6 - 51480 y^7 + 12870 y^8 + 8 x^7 (-1 + 9 y) + 
    28 x^6 (1 - 18 y + 45 y^2) + 
    56 x^5 (-1 + 27 y - 135 y^2 + 165 y^3) + 
    70 x^4 (1 - 36 y + 270 y^2 - 660 y^3 + 495 y^4) + 
    56 x^3 (-1 + 45 y - 450 y^2 + 1650 y^3 - 2475 y^4 + 1287 y^5) + 
    28 x^2 (1 - 54 y + 675 y^2 - 3300 y^3 + 7425 y^4 - 7722 y^5 + 
       3003 y^6) + 
    8 x (-1 + 63 y - 945 y^2 + 5775 y^3 - 17325 y^4 + 27027 y^5 - 
       21021 y^6 + 6435 y^7)}},
 {{-1 + 99 x - 2376 x^2 + 24024 x^3 - 126126 x^4 + 378378 x^5 - 
    672672 x^6 + 700128 x^7 - 393822 x^8 + 
    92378 x^9, (1 - 96 x + 2184 x^2 - 20384 x^3 + 95550 x^4 - 
      244608 x^5 + 346528 x^6 - 254592 x^7 + 75582 x^8) (-1 + x + 
      2 y), (-1 + 91 x - 1911 x^2 + 15925 x^3 - 63700 x^4 + 
      129948 x^5 - 129948 x^6 + 50388 x^7) (1 + x^2 - 6 y + 6 y^2 + 
      x (-2 + 6 y)), (1 - 84 x + 1575 x^2 - 11200 x^3 + 35700 x^4 - 
      51408 x^5 + 27132 x^6) (-1 + x^3 + 12 y - 30 y^2 + 20 y^3 + 
      3 x^2 (-1 + 4 y) + 3 x (1 - 8 y + 10 y^2)), (-1 + 75 x - 
      1200 x^2 + 6800 x^3 - 15300 x^4 + 11628 x^5) (1 + x^4 - 20 y + 
      90 y^2 - 140 y^3 + 70 y^4 + 4 x^3 (-1 + 5 y) + 
      x^2 (6 - 60 y + 90 y^2) + 
      4 x (-1 + 15 y - 45 y^2 + 35 y^3)), (1 - 64 x + 816 x^2 - 
      3264 x^3 + 3876 x^4) (-1 + x^5 + 30 y - 210 y^2 + 560 y^3 - 
      630 y^4 + 252 y^5 + 5 x^4 (-1 + 6 y) + 
      10 x^3 (1 - 12 y + 21 y^2) + 
      10 x^2 (-1 + 18 y - 63 y^2 + 56 y^3) + 
      5 x (1 - 24 y + 126 y^2 - 224 y^3 + 126 y^4)), (-1 + 51 x - 
      459 x^2 + 969 x^3) (1 + x^6 - 42 y + 420 y^2 - 1680 y^3 + 
      3150 y^4 - 2772 y^5 + 924 y^6 + 6 x^5 (-1 + 7 y) + 
      15 x^4 (1 - 14 y + 28 y^2) + 
      20 x^3 (-1 + 21 y - 84 y^2 + 84 y^3) + 
      15 x^2 (1 - 28 y + 168 y^2 - 336 y^3 + 210 y^4) + 
      6 x (-1 + 35 y - 280 y^2 + 840 y^3 - 1050 y^4 + 462 y^5)), (1 - 
      36 x + 171 x^2) (-1 + x^7 + 56 y - 756 y^2 + 4200 y^3 - 
      11550 y^4 + 16632 y^5 - 12012 y^6 + 3432 y^7 + 
      7 x^6 (-1 + 8 y) + 21 x^5 (1 - 16 y + 36 y^2) + 
      35 x^4 (-1 + 24 y - 108 y^2 + 120 y^3) + 
      35 x^3 (1 - 32 y + 216 y^2 - 480 y^3 + 330 y^4) + 
      21 x^2 (-1 + 40 y - 360 y^2 + 1200 y^3 - 1650 y^4 + 792 y^5) + 
      7 x (1 - 48 y + 540 y^2 - 2400 y^3 + 4950 y^4 - 4752 y^5 + 
         1716 y^6)), (-1 + 19 x) (1 + x^8 - 72 y + 1260 y^2 - 
      9240 y^3 + 34650 y^4 - 72072 y^5 + 84084 y^6 - 51480 y^7 + 
      12870 y^8 + 8 x^7 (-1 + 9 y) + 28 x^6 (1 - 18 y + 45 y^2) + 
      56 x^5 (-1 + 27 y - 135 y^2 + 165 y^3) + 
      70 x^4 (1 - 36 y + 270 y^2 - 660 y^3 + 495 y^4) + 
      56 x^3 (-1 + 45 y - 450 y^2 + 1650 y^3 - 2475 y^4 + 1287 y^5) + 
      28 x^2 (1 - 54 y + 675 y^2 - 3300 y^3 + 7425 y^4 - 7722 y^5 + 
         3003 y^6) + 
      8 x (-1 + 63 y - 945 y^2 + 5775 y^3 - 17325 y^4 + 27027 y^5 - 
         21021 y^6 + 6435 y^7)), -1 + x^9 + 90 y - 1980 y^2 + 
    18480 y^3 - 90090 y^4 + 252252 y^5 - 420420 y^6 + 411840 y^7 - 
    218790 y^8 + 48620 y^9 + x^8 (-9 + 90 y) + 
    36 x^7 (1 - 20 y + 55 y^2) + 
    84 x^6 (-1 + 30 y - 165 y^2 + 220 y^3) + 
    126 x^5 (1 - 40 y + 330 y^2 - 880 y^3 + 715 y^4) + 
    126 x^4 (-1 + 50 y - 550 y^2 + 2200 y^3 - 3575 y^4 + 2002 y^5) + 
    84 x^3 (1 - 60 y + 825 y^2 - 4400 y^3 + 10725 y^4 - 12012 y^5 + 
       5005 y^6) + 
    36 x^2 (-1 + 70 y - 1155 y^2 + 7700 y^3 - 25025 y^4 + 42042 y^5 - 
       35035 y^6 + 11440 y^7) + 
    9 x (1 - 80 y + 1540 y^2 - 12320 y^3 + 50050 y^4 - 112112 y^5 + 
       140140 y^6 - 91520 y^7 + 24310 y^8)}},
 {{1 - 120 x + 3510 x^2 - 43680 x^3 + 286650 x^4 - 1100736 x^5 + 
    2598960 x^6 - 3818880 x^7 + 3401190 x^8 - 1679600 x^9 + 
    352716 x^10, (-1 + 117 x - 3276 x^2 + 38220 x^3 - 229320 x^4 + 
      779688 x^5 - 1559376 x^6 + 1813968 x^7 - 1133730 x^8 + 
      293930 x^9) (-1 + x + 2 y), (1 - 112 x + 2940 x^2 - 31360 x^3 + 
      166600 x^4 - 479808 x^5 + 759696 x^6 - 620160 x^7 + 
      203490 x^8) (1 + x^2 - 6 y + 6 y^2 + x (-2 + 6 y)), (-1 + 
      105 x - 2520 x^2 + 23800 x^3 - 107100 x^4 + 244188 x^5 - 
      271320 x^6 + 116280 x^7) (-1 + x^3 + 12 y - 30 y^2 + 20 y^3 + 
      3 x^2 (-1 + 4 y) + 3 x (1 - 8 y + 10 y^2)), (1 - 96 x + 
      2040 x^2 - 16320 x^3 + 58140 x^4 - 93024 x^5 + 54264 x^6) (1 + 
      x^4 - 20 y + 90 y^2 - 140 y^3 + 70 y^4 + 4 x^3 (-1 + 5 y) + 
      x^2 (6 - 60 y + 90 y^2) + 
      4 x (-1 + 15 y - 45 y^2 + 35 y^3)), (-1 + 85 x - 1530 x^2 + 
      9690 x^3 - 24225 x^4 + 20349 x^5) (-1 + x^5 + 30 y - 210 y^2 + 
      560 y^3 - 630 y^4 + 252 y^5 + 5 x^4 (-1 + 6 y) + 
      10 x^3 (1 - 12 y + 21 y^2) + 
      10 x^2 (-1 + 18 y - 63 y^2 + 56 y^3) + 
      5 x (1 - 24 y + 126 y^2 - 224 y^3 + 126 y^4)), (1 - 72 x + 
      1026 x^2 - 4560 x^3 + 5985 x^4) (1 + x^6 - 42 y + 420 y^2 - 
      1680 y^3 + 3150 y^4 - 2772 y^5 + 924 y^6 + 6 x^5 (-1 + 7 y) + 
      15 x^4 (1 - 14 y + 28 y^2) + 
      20 x^3 (-1 + 21 y - 84 y^2 + 84 y^3) + 
      15 x^2 (1 - 28 y + 168 y^2 - 336 y^3 + 210 y^4) + 
      6 x (-1 + 35 y - 280 y^2 + 840 y^3 - 1050 y^4 + 
         462 y^5)), (-1 + 57 x - 570 x^2 + 1330 x^3) (-1 + x^7 + 
      56 y - 756 y^2 + 4200 y^3 - 11550 y^4 + 16632 y^5 - 12012 y^6 + 
      3432 y^7 + 7 x^6 (-1 + 8 y) + 21 x^5 (1 - 16 y + 36 y^2) + 
      35 x^4 (-1 + 24 y - 108 y^2 + 120 y^3) + 
      35 x^3 (1 - 32 y + 216 y^2 - 480 y^3 + 330 y^4) + 
      21 x^2 (-1 + 40 y - 360 y^2 + 1200 y^3 - 1650 y^4 + 792 y^5) + 
      7 x (1 - 48 y + 540 y^2 - 2400 y^3 + 4950 y^4 - 4752 y^5 + 
         1716 y^6)), (1 - 40 x + 210 x^2) (1 + x^8 - 72 y + 
      1260 y^2 - 9240 y^3 + 34650 y^4 - 72072 y^5 + 84084 y^6 - 
      51480 y^7 + 12870 y^8 + 8 x^7 (-1 + 9 y) + 
      28 x^6 (1 - 18 y + 45 y^2) + 
      56 x^5 (-1 + 27 y - 135 y^2 + 165 y^3) + 
      70 x^4 (1 - 36 y + 270 y^2 - 660 y^3 + 495 y^4) + 
      56 x^3 (-1 + 45 y - 450 y^2 + 1650 y^3 - 2475 y^4 + 1287 y^5) + 
      28 x^2 (1 - 54 y + 675 y^2 - 3300 y^3 + 7425 y^4 - 7722 y^5 + 
         3003 y^6) + 
      8 x (-1 + 63 y - 945 y^2 + 5775 y^3 - 17325 y^4 + 27027 y^5 - 
         21021 y^6 + 6435 y^7)), (-1 + 21 x) (-1 + x^9 + 90 y - 
      1980 y^2 + 18480 y^3 - 90090 y^4 + 252252 y^5 - 420420 y^6 + 
      411840 y^7 - 218790 y^8 + 48620 y^9 + x^8 (-9 + 90 y) + 
      36 x^7 (1 - 20 y + 55 y^2) + 
      84 x^6 (-1 + 30 y - 165 y^2 + 220 y^3) + 
      126 x^5 (1 - 40 y + 330 y^2 - 880 y^3 + 715 y^4) + 
      126 x^4 (-1 + 50 y - 550 y^2 + 2200 y^3 - 3575 y^4 + 
         2002 y^5) + 
      84 x^3 (1 - 60 y + 825 y^2 - 4400 y^3 + 10725 y^4 - 12012 y^5 + 
         5005 y^6) + 
      36 x^2 (-1 + 70 y - 1155 y^2 + 7700 y^3 - 25025 y^4 + 
         42042 y^5 - 35035 y^6 + 11440 y^7) + 
      9 x (1 - 80 y + 1540 y^2 - 12320 y^3 + 50050 y^4 - 112112 y^5 + 
         140140 y^6 - 91520 y^7 + 24310 y^8)), 
   1 + x^10 - 110 y + 2970 y^2 - 34320 y^3 + 210210 y^4 - 
    756756 y^5 + 1681680 y^6 - 2333760 y^7 + 1969110 y^8 - 
    923780 y^9 + 184756 y^10 + 10 x^9 (-1 + 11 y) + 
    45 x^8 (1 - 22 y + 66 y^2) + 
    120 x^7 (-1 + 33 y - 198 y^2 + 286 y^3) + 
    210 x^6 (1 - 44 y + 396 y^2 - 1144 y^3 + 1001 y^4) + 
    252 x^5 (-1 + 55 y - 660 y^2 + 2860 y^3 - 5005 y^4 + 3003 y^5) + 
    210 x^4 (1 - 66 y + 990 y^2 - 5720 y^3 + 15015 y^4 - 18018 y^5 + 
       8008 y^6) + 
    120 x^3 (-1 + 77 y - 1386 y^2 + 10010 y^3 - 35035 y^4 + 
       63063 y^5 - 56056 y^6 + 19448 y^7) + 
    45 x^2 (1 - 88 y + 1848 y^2 - 16016 y^3 + 70070 y^4 - 
       168168 y^5 + 224224 y^6 - 155584 y^7 + 43758 y^8) + 
    10 x (-1 + 99 y - 2376 y^2 + 24024 y^3 - 126126 y^4 + 
       378378 y^5 - 672672 y^6 + 700128 y^7 - 393822 y^8 + 92378 y^9)}}
}""".replace('{',' ').replace('}',' ').replace('\n ','')[1:-1].split(',')
# ssss  = [s[1:-1].replace(' (','*(') for s in ssss]
# ssss
# "[](vector3f xyz) {Scalar x=xyz[0],y=xyz[1],z=xyz[2]; return -1 + xyz[0] + 3*xyz[1]; },"



with open('DG_Basis_High_Order_2D.h','w') as f:
    for i in range(len(ssss)):
        print(generate_cpp_code(i,parse_basis(ssss[i])),file=f)